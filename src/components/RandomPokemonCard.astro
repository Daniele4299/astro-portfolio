---
import Card from "./Card/index.astro";
---

<Card colSpan="md:col-span-1" rowSpan="md:row-span-1" class="flex items-center justify-center h-full relative">
  <div id="pokemonContainer" class="flex flex-col items-center justify-center h-full gap-4">
    <!-- Sezione che mostrerà il Pokémon selezionato -->
    <div id="pokemonDisplay" class="text-center text-lg font-bold hidden flex items-center">
      <img id="pokemonSprite" src="" alt="" class="w-24 h-24 mr-2 hidden" />
      <span id="pokemonText"></span>
    </div>

    <div id="pokeballButtons" class="flex justify-center items-center gap-4">
      {Array.from({ length: 3 }, (_, index) => (
        <button key={index} class="pokeball-button" aria-label={`Pokéball ${index + 1}`}></button>
      ))}
    </div>
  </div>

  <div id="fadeOverlay" class="fixed inset-0 bg-white opacity-0 pointer-events-none transition-opacity duration-500"></div>
</Card>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const starterPokemon = [
      "Bulbasaur", "Charmander", "Squirtle", "Chikorita", "Cyndaquil", "Totodile",
      "Treecko", "Torchic", "Mudkip", "Turtwig", "Chimchar", "Piplup",
      "Snivy", "Tepig", "Oshawott"
    ];

    const buttons = document.querySelectorAll(".pokeball-button");
    const pokemonDisplay = document.getElementById("pokemonDisplay");
    const pokemonSprite = document.getElementById("pokemonSprite");
    const pokemonText = document.getElementById("pokemonText");
    const pokeballButtonsContainer = document.getElementById("pokeballButtons");
    const fadeOverlay = document.getElementById("fadeOverlay");

    buttons.forEach((button) => {
      button.addEventListener("click", () => {
        fadeOverlay.classList.replace("opacity-0", "opacity-100");
        fadeOverlay.classList.remove("pointer-events-none");

        setTimeout(() => {
          const randomPokemon = starterPokemon[Math.floor(Math.random() * starterPokemon.length)];
          pokemonText.textContent = `You caught a ${randomPokemon}!`;
          pokemonSprite.src = `https://img.pokemondb.net/sprites/black-white/normal/${randomPokemon.toLowerCase()}.png`;
          pokemonSprite.alt = randomPokemon;

          pokemonSprite.classList.remove("hidden");
          pokemonDisplay.classList.remove("hidden");
          pokeballButtonsContainer.classList.add("hidden");

          fadeOverlay.classList.replace("opacity-100", "opacity-0");
          fadeOverlay.classList.add("pointer-events-none");
        }, 500);
      });
    });
  });
</script>

<style>
  .pokeball-button {
    width: 60px; /* Dimensione del bottone */
    height: 60px; /* Dimensione del bottone */
    background: url('/pokeball_animation2.gif') no-repeat center center; /* Aggiungi la GIF come sfondo */
    background-size: contain; /* Adatta la GIF alla dimensione del bottone */
    border: none; /* Rimuovi il bordo */
    cursor: pointer; /* Cambia il cursore per indicare che è cliccabile */
    transition: transform 0.2s ease;
  }

  .pokeball-button:hover {
    transform: scale(1.1);
  }

  .hidden {
    display: none;
  }

  #fadeOverlay {
    z-index: 10;
  }
</style>
